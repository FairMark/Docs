# Честный знак

Честный знак состоит из систем МДЛП (мониторинг движения лекарственных препаратов)
и ГИС МТ (государственная информационная система маркировки товаров). Работа с ними
ведется через разные API и разные библиотеки.

## Архив документации

Этот репозиторий предназначен для личного пользования, т.к. я не всегда способен
отыскать нужные документы на сайте Честного знака. Для получения последних актуальных
документов всегда нужно искать их на сайте https://честныйзнак.рф.

## МДЛП (Лекарственные препараты)

Для медицинских препаратов см. проект MdlpApiClient.

## ГИС МТ (Маркировка товаров)

Для начала работы с системой потребуется регистрация в тестовом контуре ГИС МТ.
Тестовый контур Маркировки расположен здесь:

https://markirovka.demo.crpt.tech/

Зарегистрироваться в тестовом контуре можно самостоятельно. Для регистрации 
потребуются реальные реквизиты юридического лица. На эти реквизиты оформляется
тестовая усиленная электронная подпись (УКЭП). Подпись можно зарегистрировать
здесь:

https://testca2012.cryptopro.ru/ui

Сайт работает только в Internet Explorer. Для работы сайта требуется установленный
плагин КриптоПро последней верии. Цифровая подпись выпускается от имени тестового
удостоверяющего центра, использовать ее в продакшне нельзя. Она годится только для
экспериментов с тестовым контуром ГИС Маркировка.

На сайте регистрации УЦ нужно указать реальные реквизиты компании, иначе регистрация
в тестовом контуре Маркировки не пройдет (при регистрации сертификат сверяется с
реестром ЕГРЮЛ). Только email и телефон надо указывать свой: на этот email будут
приходить уведомления о регистрации. Если все заполнено верно, регистрация происходит 
быстро, несмотря на то, что сайт пугает регистрацией в течение 24 часов.

При первом выпуске сертификата заполняются все реквизиты и выдается логин-пароль.
С помощью логина можно зайти на сайт УЦ и перевыпустить сертификат, когда он истек.
Что произойдет с тестовой учетной записью ГИС Маркировка при перевыпуске сертификата,
я пока не знаю. Скорее всего, регистрация сохранится.

После регистрации ГИС потребует дозаполнить все реквизиты, которых не было в
сертификате: ИФНС, адрес прописки директора, список сотрудников и пр.
Описание процесса регистрации во всех подробностях содержится здесь:

https://честныйзнак.рф/upload/Тестовый_УКЭП.pdf

### Какой API использовать

Есть несколько документов по интеграции с ГИС МТ. Начать изучение имеет смысл
с краткого руководства по работе с API, расположенного по адресу:

https://честныйзнак.рф/upload/Краткое_руководство_по_работе_с_API.pdf

В руководстве есть такой фрагмент:

> # 1. Документация
>
> Документация для интеграции с ГИС МТ:
>
> * «API каталога маркированных товаров» - заполнение карточек товаров в
> «Национальном каталоге маркированных товаров»;
> * «Руководство программиста СУЗ-Облако (API)» - заказ кодов маркировки в Станции
> управления заказами;
> * «Описание True API» - для проведения операций с маркированным товаром;
> * «API ЭДО Lite» - осуществление отгрузки УПД другому участнику оборота товаров,
> подключённому к ЭДО Lite или коммерческому оператору ЭДО;
> * «Методические рекомендации по оформлению электронных документов (УПД,
> УКД)»;
> * «Рекомендуемый алгоритм экранирования специальных символов в коде
> идентификации».
>
> **На текущий момент есть также «Описание API ГИС МТ», однако призываем
> осуществлять интеграцию через True API.**

Таким образом, основным рабочим документом, по-видимому, будет описание True API.

### Установка соединения

Этот квест я еще не прошел. Пока непонятно, какой URL API тестового контура надо
использовать: все, которые я попробовал, выдают ошибку 403 или 404.
